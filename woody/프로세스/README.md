## 프로세스

### 프로그램의 실행 (메모리 load)

1. 파일 시스템 디스크의 실행 파일(exe 등)을 실행시키면
2. 가상 메모리를 할당받은 프로세스가 되고
3. 그 가상 메모리는 스왑 영역 디스크에 들어있다가
4. CPU에 할당이 가능한 상황이 오면 물리 메모리로 할당된다.

가상 메모리 주소(논리 주소) 물리 메모리 주소(물리 주소)는 다르다

→ 주소 변환 작업이 필요하다

</br>



### 가상 메모리 공간

특정 프로그램만의 독자적인 가상의 메모리 공간

- code : CPU에서 실행될 기계어 코드들이 들어가있다

- data : 프로그램이 실행되다가 변수, 배열 등 (전역변수 등)이 저장된다

- stack : 함수 호출과 관련된 데이터들이 쌓이는 영역(caller/callee) - 지역변수는 여기에 저장
  - 물리 메모리의 커널 영역도 같은 구조

![가상메모리](./imgs/가상메모리.png)



> 커널 주소 공간도 가상 주소 공간처럼 Stack, Data, Code 영역을 가진다
>
> - Code : 시스템콜, 인터럽트 처리 코드 등의 커널 코드 저장
> - Data : CPU, 메모리, 디스크, PCB(Process Control Block) 등이 저장
> - Stack : 각 프로세스의 커널 스택 정보가 저장된다(프로세스간의 호출 스택 저장)



### 사용자 프로그램이 사용하는 함수

#### 가상 주소 영역의 코드에 저장된 함수

- **사용자 정의 함수**
  - 자신의 프로그램에서 정의한 함수
- **라이브러리 함수**
  - 내 코드는 아니지만 내 프로그램의 실행 파일에 포함된 함수

#### 커널 주소 영역의 코드에 저장된 함수

- **커널 함수**
  - 내 코드가 아닌 커널에 들어있는 코드
  - 시스템 콜을 통해 커널모드로 전환될 때 사용할 수 있는 특수한 함수



### 프로그램의 실행

- CPU의 제어권이 어디로 가는가?
- 평소에는 사용자 모드로 해당 프로세스의 주소공간에 있는 메모리를 사용하게 됨
- 시스템 콜을 할 경우 CPU 제어권이 운영 체제로 넘어가, 운영체제 영역의 메모리를 사용하게 됨

<img src="./imgs/프로그램-실행.png" alt="프로그램-실행" style="zoom:80%;" />